<!DOCTYPE html>
<html lang="es">
      <head>
        <title>Productos | MenuLab</title>
        <meta property="og:title" content="MenuLab" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta property="twitter:card" content="summary_large_image" />
        <link rel="stylesheet" href="https://unpkg.com/animate.css@4.1.1/animate.css" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" data-tag="font" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=STIX+Two+Text:wght@400;700&display=swap" data-tag="font" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@100..900&display=swap" data-tag="font" />
        <link rel="stylesheet" href="https://unpkg.com/@teleporthq/teleport-custom-scripts/dist/style.css" />
        <link rel="stylesheet" href="./style.css" />
        <link rel="stylesheet" href="./index.css" />
        <link rel="stylesheet" href="form.css" />
        <script src="form.js" defer></script>
      </head>

    <body>
        <div class="container">
            <div class="form-container">
                <div class="form-header" style="background: linear-gradient(90deg, #4f8cff 0%, #6dd5ed 100%); border-radius: 18px; padding: 32px 24px 24px 24px; box-shadow: 0 4px 24px rgba(79,140,255,0.10); margin-bottom: 32px; color: #fff; text-align: center; position: relative;">
                    <div style="position: absolute; top: 18px; left: 24px; font-size: 2.2rem; opacity: 0.15; pointer-events: none;">üöÄ</div>
                    <h3 style="font-size: 1.5rem; font-weight: 700; letter-spacing: 1px; margin-bottom: 10px; color: #fff; text-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                        Productos Seleccionados
                    </h3>
                    <h2 style="font-size: 1.15rem; font-weight: 400; margin-bottom: 18px; color: #e3f2fd;">
                        Complet√° los pasos para activar tu sitio y acceder a los beneficios de tu compra
                    </h2>
                    <div style="display: flex; align-items: center; justify-content: center; gap: 10px; background: rgba(255,255,255,0.13); border-radius: 12px; padding: 10px 18px; margin: 0 auto; max-width: 420px;">
                        <span style="font-size: 1.6rem;">üéÅ</span>
                        <span style="font-size: 1.05rem; font-weight: 500; color: #fff;">
                            <b>¬°Ped√≠ tu muestrario gratis!</b>
                        </span>
                    </div>
                </div>
                
                <form id="sponsorshipForm">
                    <div class="form-progress">
                        <div class="progress-bar">
                            <div class="progress-fill"></div>
                        </div>
                        <div class="progress-steps">
                            <div class="step active" data-step="1">
                                <div class="step-label">Men√∫</div>
                            </div>
                            <div class="step" data-step="2">
                                <div class="step-label">Complementos y Web</div>
                            </div>
                            <div class="step" data-step="3">
                                <div class="step-label">Datos Personales</div>
                            </div>
                            <div class="step" data-step="4">
                                <div class="step-label">Datos Negocio</div>
                            </div>
                            <div class="step" data-step="5">
                                <div class="step-label">Pago</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Step 1: Men√∫ y Combos -->
                    <div class="form-step active" data-step="1" id="step1">
                    <div class="checkbox-group">
                        <label><input type="checkbox" class="product-checkbox cart-checkbox" data-product="cartadoblefaz" data-price="150000"> Men√∫ D√∫o</label>
                        <label><input type="checkbox" class="product-checkbox cart-checkbox" data-product="cartadoblefaza3" data-price="200000"> Men√∫ D√∫o XL</label>
                        <label><input type="checkbox" class="product-checkbox cart-checkbox" data-product="cartalibro4caras" data-price="200000"> Men√∫ D√∫o Pro</label>
                        <label><input type="checkbox" class="product-checkbox cart-checkbox" data-product="cartatriptica" data-price="200000"> Men√∫ Triple Impacto</label>
                        <label><input type="checkbox" class="product-checkbox cart-checkbox" data-product="cartaanillada" data-price="250000"> Men√∫ Sin L√≠mite</label>
                        <label><input type="checkbox" class="product-checkbox cart-checkbox" data-product="paquete1" data-price="350000"> Paquete Doble Men√∫ (2 menues)</label>
                        <label><input type="checkbox" class="product-checkbox cart-checkbox" data-product="paquete2" data-price="400000"> Paquete F√≠sico (consultor√≠a + men√∫ + 3 complementos)</label>
                        <label><input type="checkbox" class="product-checkbox cart-checkbox" data-product="paquete3" data-price="500000"> Paquete Digital (consultor√≠a + ProSite + men√∫)</label>
                    </div>
                    <div id="totalAmount" aria-live="polite" style="margin-top:12px;font-weight:700;"></div>
                    <div id="formError" class="form-error" style="display:none;"></div>
                    <div class="form-buttons">
                        <button type="button" class="btn next-btn">Continuar</button>
                    </div>
                    </div>
                
                <!-- Step 2: Complementos y Web -->
                <div class="form-step" data-step="2">
                    <div class="checkbox-group">
                        <label><input type="checkbox" class="product-checkbox cart-checkbox" data-product="individual" data-price="150000"> Individual de Mesa</label>
                        <label><input type="checkbox" class="product-checkbox cart-checkbox" data-product="exhibicion" data-price="50000"> Men√∫ de Calle</label>
                        <label><input type="checkbox" class="product-checkbox cart-checkbox" data-product="menumesas" data-price="50000"> Men√∫ de Mesa</label>
                        <label><input type="checkbox" class="product-checkbox cart-checkbox" data-product="tarjeta" data-price="50000"> Tarjeta de Descuento</label>
                        <label><input type="checkbox" class="product-checkbox cart-checkbox" data-product="flyer" data-price="50000"> Flyer Promocional</label>
                        <label><input type="checkbox" class="product-checkbox cart-checkbox" data-product="portavasos" data-price="50000"> Posavaso</label>
                        <label><input type="checkbox" class="product-checkbox cart-checkbox" data-product="traduccion" data-price="75000"> Traducci√≥n al Ingl√©s</label>
                        <label><input type="checkbox" class="product-checkbox cart-checkbox" data-product="Consultoria" data-price="110000"> Consultor√≠a de Men√∫</label>
                        <label><input type="checkbox" class="product-checkbox cart-checkbox" data-product="microsite" data-price="120000"> MicroSite</label>
                        <label><input type="checkbox" class="product-checkbox cart-checkbox" data-product="prosite" data-price="300000"> ProSite</label>
                    </div>
                    <div id="totalAmountStep2" aria-live="polite" style="margin-top:12px;font-weight:700;"></div>
                    <div class="form-buttons">
                        <button type="button" class="btn prev-btn">Atr√°s</button>
                        <button type="button" class="btn next-btn">Continuar</button>
                    </div>
                </div>

                <!-- Step 3: Personal Information -->
                <div class="form-step" data-step="3">
                    <h2>Informaci√≥n Personal</h2>
                    <div class="form-group">
                        <label for="firstName">Nombre</label>
                        <input type="text" id="firstName" name="firstName" required>
                    </div>
                    <div class="form-group">
                        <label for="lastName">Apellido</label>
                        <input type="text" id="lastName" name="lastName" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">Tel√©fono de contacto</label>
                        <input type="tel" id="phone" name="phone" required>
                    </div>
                    <div class="form-buttons">
                        <button type="button" class="btn prev-btn">Atr√°s</button>
                        <button type="button" class="btn next-btn">Continuar</button>
                    </div>
                </div>
                
                <!-- Step 4: Sponsorship Details -->
                <div class="form-step" data-step="4">
                    <h2>Informaci√≥n de tu Negocio</h2>
                    <div class="form-group">
                        <label for="companyName">Nombre de tu Negocio</label>
                        <input type="text" id="companyName" name="companyName">
                    </div>
                    <div class="form-group">
                        <label for="websiteUrl">Direcci√≥n</label>
                        <input type="text" id="websiteUrl" name="websiteUrl">
                    </div>
                    <div class="form-group">
                        <label for="sponsorshipLevel">Pa√≠s</label>
                        <select id="sponsorshipLevel" name="sponsorshipLevel" required>
                            <option value="bronze">Argentina</option>
                            <option value="bronze">Uruguay</option>
                            <option value="silver">Chile</option>
                            <option value="gold">Espa√±a</option>
                            <option value="platinum">USA</option>
                        </select>
                    </div>
                    <div class="form-group" id="customAmountContainer" style="display: none;">
                        <label for="customAmount">Custom Amount ($)</label>
                        <input type="number" id="customAmount" name="customAmount" min="10000">
                    </div>
                    <h2>Informaci√≥n Adicional</h2>
                    <div class="form-group">
                        <label for="hearAbout">¬øC√≥mo nos conociste?</label>
                        <select id="hearAbout" name="hearAbout">
                            <option value="" disabled selected>Por favor seleccion√°</option>
                            <option value="instagram">Instagram</option>
                            <option value="mercadolibre">Mercado Libre</option>
                            <option value="colegas">Colegas</option>
                            <option value="whatsapp">Whatsapp</option>
                            <option value="email">Email</option>
                            <option value="other">Otro</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="comments">Comentarios Adicionales</label>
                        <textarea id="comments" name="comments" rows="4"></textarea>
                    </div>
                    <div class="form-group checkbox-group horizontal">
                        <input type="checkbox" id="agreeTerms" name="agreeTerms" required>
                        <label for="agreeTerms">
                            Acepto los 
                            <a href="legal.html" target="_blank" style="color:#1976d2; text-decoration:underline; font-weight:600;">
                                t√©rminos y condiciones
                            </a>
                        </label>
                    </div>
                    <div id="termsError" class="form-error" style="display:none; color: #d32f2f; margin-top: 8px;">
                        Debes aceptar los t√©rminos y condiciones.
                    </div>
                    <div class="form-buttons" style="justify-content: center;">
                        <button type="button" class="btn prev-btn">Atr√°s</button>
                        <button type="button" class="btn next-btn">Continuar</button>
                    </div>
                </div>
                
                
                <!-- Step 5: Payment -->
                <div class="form-step" data-step="5">
                    <div id="planInfo"></div>
                    <div id="selectedProductsDetail" style="margin-bottom:16px;"></div>
                    <div class="success-message">
                        <!-- √çcono MercadoPago -->
                        <div style="display:flex;justify-content:center;margin-bottom:12px;">
                            <img src="MPicon.svg" alt="MercadoPago" style="width:80px;height:auto;">
                        </div>
                            <p>Proteg√© tu compra con Mercado Pago</p>
                            <p>Luego del pago se te enviar√° al mail toda la info necesario para comenzar a editar tu men√∫</p>
                            <div style="display: flex; justify-content: center; gap: 12px; margin-top: 16px;">
                                <button type="button" class="btn prev-btn">Atr√°s</button>
                                <a href="https://link.mercadopago.com.ar/barmodelo"
                                    name="MP-payButton"
                                    class="blue-button"
                                    target="_blank"
                                    rel="noopener noreferrer">Comprar</a>
                            </div>
                        </div>
                    </div>
                </form>


            </div>
        </div>

        <!--Footer4 component-->
        <footer4-wrapper class="footer4-wrapper">
            <footer class="footer4-footer7 thq-section-padding">
                <div class="footer4-max-width thq-section-max-width">
                    <div class="footer4-content">
                        <div class="footer4-credits">
                            <div class="thq-divider-horizontal"></div>
                            <div class="footer4-row">
                                <div class="footer4-container">
                                    <span class="thq-body-small">¬© 2025 MenuLab</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </footer>
        </footer4-wrapper>
        <script>
        document.addEventListener('DOMContentLoaded', function () {
            // --- Sincronizar checkboxes con localStorage (cart) ---
            function getCart() {
                return JSON.parse(localStorage.getItem('cart') || '[]');
            }
            const cart = getCart();
            document.querySelectorAll('.cart-checkbox').forEach(checkbox => {
                if (cart.includes(checkbox.dataset.product)) {
                    checkbox.checked = true;
                }
            });

            // --- L√≥gica de productos seleccionados y total ---
            let selectedProducts = [];
            let total = 0;

            function updateSelectedProducts() {
                selectedProducts = [];
                total = 0;
                document.querySelectorAll('.product-checkbox:checked').forEach(cb => {
                    const label = cb.parentElement.textContent.trim();
                    const price = Number(cb.dataset.price);
                    selectedProducts.push({ name: label, price: price });
                    total += price;
                });
                // Guarda en sessionStorage para usar en el paso 4
                sessionStorage.setItem('selectedProducts', JSON.stringify(selectedProducts));
                sessionStorage.setItem('selectedTotal', total);
            }

            // Actualiza el total en el paso 1 y paso 2 en tiempo real
            document.querySelectorAll('.product-checkbox').forEach(cb => {
                cb.addEventListener('change', function () {
                    updateSelectedProducts();

                    // Total SOLO de productos del paso 1
                    let totalStep1 = 0;
                    document.querySelectorAll('.form-step[data-step="1"] .product-checkbox:checked').forEach(cb1 => {
                        totalStep1 += Number(cb1.dataset.price);
                    });
                    document.getElementById('totalAmount').innerHTML =
                        `<strong>Total: $${totalStep1.toLocaleString('es-AR')}</strong>`;

                    // Total general (todos los productos seleccionados)
                    const _t = Number(sessionStorage.getItem('selectedTotal') || 0);
                    const _pct = Number(sessionStorage.getItem('discountPct') || 0);
                    const _td = _pct ? Math.round(_t * (1 - _pct/100)) : _t;
                    document.getElementById('totalAmountStep2').innerHTML = _pct
                        ? `<strong>Total: <s>$${_t.toLocaleString('es-AR')}</s> $${_td.toLocaleString('es-AR')} (-${_pct}%)</strong>`
                        : `<strong>Total: $${_td.toLocaleString('es-AR')}</strong>`;
                });
            });

            // Al avanzar de paso, guarda la selecci√≥n
            document.querySelectorAll('.next-btn').forEach(btn => {
                btn.addEventListener('click', function () {
                    updateSelectedProducts();
                });
            });

            // --- C√≥digos de descuento disponibles ---
            const DISCOUNT_CODES = {
            "MLAB-5-5A8DA": 5,   // Emprendedor Mensual
            "MLAB-10-6B7EB": 10, // Profesional Mensual
            "MLAB-15-7C6FC": 15, // Corporativo Mensual
            "MLAB-10-08E5GD": 10, // Emprendedor Anual
            "MLAB-20-9F4HE": 20, // Profesional Anual
            "MLAB-30-0G3IF": 30  // Corporativo Anual
            };

            // Mostrar detalle en el paso 4
            function showSelectedProductsDetail() {
                const detailDiv = document.getElementById('selectedProductsDetail');
                const products = JSON.parse(sessionStorage.getItem('selectedProducts') || '[]');
                const total = Number(sessionStorage.getItem('selectedTotal') || 0);

                // Datos de descuento persistidos (si ya se aplic√≥ antes)
                const savedPct = Number(sessionStorage.getItem('discountPct') || 0);
                const savedCode = (sessionStorage.getItem('discountCode') || '');

                if (products.length === 0) {
                    detailDiv.innerHTML = "<em>No seleccionaste productos.</em>";
                    return;
                }

                // Lista de productos
                let html = "<strong>Productos seleccionados:</strong><ul style='margin:8px 0 8px 16px;'>";
                products.forEach(p => {
                    html += `<li>${p.name} <span style="color:#888;">$${Number(p.price).toLocaleString('es-AR')}</span></li>`;
                });
                html += "</ul>";

                // --- Row de descuento ---
                html += `
                    <div id="discountRow" style="
                    margin:12px 0; padding:10px; background:#f8f9fa; border-radius:10px;
                    display:flex; gap:8px; flex-wrap:wrap; align-items:center;">
                    <input id="discountCode" type="text" placeholder="C√≥digo de descuento"
                            value="${savedCode}"
                            style="flex:1 1 180px; padding:.5rem .75rem; border:1px solid #ccd; border-radius:999px;">
                    <button id="applyDiscountBtn" type="button"
                            style="padding:.5rem .9rem; border-radius:999px; border:1px solid #457B9D; background:#fff; color:#457B9D; font-weight:600;">
                        Aplicar
                    </button>
                    <button id="clearDiscountBtn" type="button"
                            style="padding:.5rem .9rem; border-radius:999px; border:1px solid #bbb; background:#fff; color:#666; font-weight:600; ${savedPct ? '' : 'display:none;'}">
                        Quitar
                    </button>
                    <span id="discountMsg" style="font-size:.9rem; ${savedPct ? 'color:#198754' : ''}">
                        ${savedPct ? `C√≥digo aplicado (-${savedPct}%)` : ''}
                        </span>
                        </div>
                `;

                // C√°lculo con descuento si aplica
                const pct = savedPct > 0 ? savedPct : 0;
                const discounted = pct ? Math.round(total * (1 - pct / 100)) : total;
    
                // Actualiza el texto del bot√≥n de pago con el total final
                const payBtn = document.querySelector('a.blue-button[name="MP-payButton"]');
                if (payBtn) {
                const hasProducts = products.length > 0;
                payBtn.textContent = hasProducts
                    ? (pct ? `Pagar $${discounted.toLocaleString('es-AR')}` : `Pagar $${total.toLocaleString('es-AR')}`)
                    : 'Comprar';
                }

                if (pct) {
                    html += `<div><strong>Total a pagar: <s>$${total.toLocaleString('es-AR')}</s> $${discounted.toLocaleString('es-AR')} (-${pct}%)</strong></div>`;
                } else {
                    html += `<div><strong>Total a pagar: $${total.toLocaleString('es-AR')}</strong></div>`;
                }

                detailDiv.innerHTML = html;

                // Tambi√©n actualiza el total en el span principal si existe
                const priceValue = document.querySelector('.priceValue');
                if (priceValue) priceValue.textContent = discounted.toLocaleString('es-AR');

                // Listeners de la row
                const applyBtn = document.getElementById('applyDiscountBtn');
                const clearBtn = document.getElementById('clearDiscountBtn');
                const input    = document.getElementById('discountCode');
                const msg      = document.getElementById('discountMsg');

                function applyDiscount() {
                    const code = (input.value || '').toUpperCase().trim();
                    const found = DISCOUNT_CODES[code];
                    if (found) {
                    sessionStorage.setItem('discountCode', code);
                    sessionStorage.setItem('discountPct', String(found));
                    // re-render para refrescar totales y UI (tachado, bot√≥n quitar, etc.)
                    showSelectedProductsDetail();
                    } else {
                    msg.style.color = '#dc3545';
                    msg.textContent = 'C√≥digo inv√°lido';
                    }
                }

                function clearDiscount() {
                    sessionStorage.removeItem('discountCode');
                    sessionStorage.removeItem('discountPct');
                    showSelectedProductsDetail();
                }

                applyBtn.addEventListener('click', applyDiscount);
                input.addEventListener('keyup', e => { if (e.key === 'Enter') applyDiscount(); });
                clearBtn.addEventListener('click', clearDiscount);

                const _t  = Number(sessionStorage.getItem('selectedTotal') || 0);
                const _pc = Number(sessionStorage.getItem('discountPct') || 0);
                const _td = _pc ? Math.round(_t * (1 - _pc/100)) : _t;
                const totalAmountEl = document.getElementById('totalAmount');
                if (totalAmountEl) {
                totalAmountEl.innerHTML = _pc
                    ? `<strong>Total: <s>$${_t.toLocaleString('es-AR')}</s> $${_td.toLocaleString('es-AR')} (-${_pc}%)</strong>`
                    : `<strong>Total: $${_td.toLocaleString('es-AR')}</strong>`;
                }

            }

            // Detecta cuando se muestra el paso 4 y actualiza el detalle
            const observer = new MutationObserver(() => {
                const step4 = document.querySelector('.form-step[data-step="4"]');
                if (step4 && step4.classList.contains('active')) {
                    showSelectedProductsDetail();
                }
            });
            observer.observe(document.body, { subtree: true, attributes: true, attributeFilter: ['class'] });

            // Inicializa el total al cargar
            updateSelectedProducts();
            {
                const _t = Number(sessionStorage.getItem('selectedTotal') || 0);
                const _pct = Number(sessionStorage.getItem('discountPct') || 0);
                const _td = _pct ? Math.round(_t * (1 - _pct/100)) : _t;
                const totalAmountEl = document.getElementById('totalAmount');
                if (totalAmountEl) {
                    totalAmountEl.innerHTML = _pct
                    ? `<strong>Total: <s>$${_t.toLocaleString('es-AR')}</s> $${_td.toLocaleString('es-AR')} (-${_pct}%)</strong>`
                    : `<strong>Total: $${_td.toLocaleString('es-AR')}</strong>`;
                }
            }

            // Validaci√≥n de t√©rminos y condiciones en el paso 3
            document.querySelectorAll('.form-step[data-step="3"] .next-btn').forEach(btn => {
                btn.addEventListener('click', function (e) {
                    const agreeTerms = document.getElementById('agreeTerms');
                    const termsError = document.getElementById('termsError');
                    if (!agreeTerms.checked) {
                        e.preventDefault();
                        termsError.style.display = "block";
                        agreeTerms.focus();
                    } else {
                        termsError.style.display = "none";
                    }
                });
            });
        });
        </script>
    </body>
</html>