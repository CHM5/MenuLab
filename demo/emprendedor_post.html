<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Men√∫ - MenuLab</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="https://res.cloudinary.com/drxznqm61/image/upload/v1758652390/The_Pent_2_a8vhtp.jpg" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <!-- Grupo 1 -->
  <link href="https://fonts.googleapis.com/css2?family=Almendra+Display&family=Amatic+SC:wght@400;700&family=Anton&family=Caveat:wght@400;700&family=Codystar:wght@300;400&family=Cormorant+Garamond:wght@400;700&family=Coral+Pixels&display=swap" rel="stylesheet">

  <!-- Grupo 2 -->
  <link href="https://fonts.googleapis.com/css2?family=Ewert&family=Indie+Flower&family=Merriweather:wght@400;700&family=Milonga&family=Monoton&family=Montserrat:wght@400;700&family=Oswald:wght@400;700&display=swap" rel="stylesheet">

  <!-- Grupo 3 -->
  <link href="https://fonts.googleapis.com/css2?family=Major+Mono+Display&family=Chokokutai&family=Pacifico&family=Playfair+Display:wght@400;700&family=Quicksand:wght@400;700&family=Ranchers:wght@400;700&family=Rubik+Wet+Paint&family=Sora:wght@400;700&family=Source+Code+Pro:wght@400;700&family=Tangerine:wght@400;700&family=Vast+Shadow&display=swap" rel="stylesheet">

<style>
  :root {
    --color-nombre-resto: #000;
    --color-nombre-slogan: #000;
    --color-categoria: #000;
    --color-subcategoria: #000;
    --color-plato: #000;
    --color-descripcion: #555;
    --color-precio: #000;
    --color-info-resto: #000;
    --color-bg: #fff;

    --font-nombre-resto: 'Lato', sans-serif;
    --font-nombre-slogan: 'Lato', sans-serif;
    --font-categoria: 'Lato', sans-serif;
    --font-subcategoria: 'Lato', sans-serif;
    --font-plato: 'Lato', sans-serif;
    --font-descripcion: 'Lato', sans-serif;
    --font-precio: 'Lato', sans-serif;
    --font-info-resto: 'Lato', sans-serif;

    --bg-opacity: 0.15;
    --bg-size-scale: 100%;
    --menu-columns: 2;
    --firulete-opacity: 0.4;

    --logo-size: 100px;
    --size-nombre-resto: 2rem;
    --size-nombre-slogan: 1rem;
    --size-categoria: 1.5rem;
    --size-subcategoria: 1rem;
    --size-plato: 0.95rem;
    --size-descripcion: 0.85rem;
    --size-precio: 0.9rem;
    --size-info-resto: 0.8rem;
    --tracking: 0px;
  }

  body {
    font-family: 'Lato', sans-serif;
    margin: 0 auto;
    background: var(--color-bg);
    letter-spacing: var(--tracking);
    color: var(--color-plato);
    transition: all 0.25s ease;
  }

  /* === FONDO === */
  .print-background {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url("https://res.cloudinary.com/drxznqm61/image/upload/v1759872998/drilldown-removebg-preview_zczol3.png")
                no-repeat center center;
    background-size: var(--bg-size-scale);
    opacity: var(--bg-opacity);
    z-index: -1;
    pointer-events: none;
  }

/* Bloque general del encabezado */
.resto-top {
  display: flex;
  align-items: center;       /* centra verticalmente logo y texto */
  justify-content: center;   /* centra todo el conjunto horizontalmente */
  gap: 1.5rem;
  text-align: left;
  column-span: all;
  margin-bottom: 1.5rem;
}

/* Logo */
.resto-header img {
  width: var(--logo-size, 110px);
  height: var(--logo-size, 110px);
  border-radius: 50%;
  object-fit: cover;
  flex-shrink: 0;
}

/* Texto */
.resto-info {
  display: flex;
  flex-direction: column;
  justify-content: center;   /* alinea verticalmente el texto al centro del logo */
  text-align: left;
}

.resto-info h1 {
  font-family: var(--font-nombre-resto);
  font-size: var(--size-nombre-resto);
  margin: 0;
  color: var(--color-nombre-resto);
  font-weight: 700;
}

.resto-info .resto-slogan {
  font-family: var(--font-nombre-slogan);
  font-size: var(--size-nombre-slogan);
  font-style: italic;
  margin: 0.3rem 0 0;
  color: var(--color-nombre-slogan);
}

  #menuTable h3 {
    font-family: var(--font-subcategoria);
    font-size: var(--size-subcategoria);
    color: var(--color-subcategoria);
    font-style: italic;
    margin: 0.4rem 0;
    border-bottom: 1px solid rgba(0,0,0,0.08);
    page-break-after: avoid;
    break-after: avoid;
  }

  /* === CATEGOR√çAS Y PLATOS === */
  h2 {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    font-family: var(--font-categoria);
    font-size: var(--size-categoria);
    color: var(--color-categoria);
    font-weight: bold;
    text-align: center;
    margin: 1.2rem 0 0.8rem;
    column-span: all;
  }

  h2::before,
  h2::after {
    content: var(--firulete, "‚ú¶ ‚ú¶ ‚ú¶");
    /* üëá el firulete escala autom√°ticamente con la categor√≠a */
    font-size: calc(var(--size-categoria) * 0.6);
    color: var(--color-categoria);
    opacity: var(--firulete-opacity, 0.4);
    transition: font-size 0.25s ease, opacity 0.25s ease;
  }

  .menu-item {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    padding: 0.35rem 0;
    break-inside: avoid-column;
    page-break-inside: avoid;
    transition: background 0.2s ease;
  }

  .menu-item:hover {
    background: rgba(0,0,0,0.03);
  }

  .menu-plate {
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  .menu-plate h4 {
    font-family: var(--font-plato);
    font-size: var(--size-plato);
    color: var(--color-plato);
    margin: 0;
    font-weight: 700;
  }

  .menu-description {
    font-family: var(--font-descripcion);
    font-size: var(--size-descripcion);
    color: var(--color-descripcion);
    margin: 0.2rem 0 0;
  }

  .menu-price {
    font-family: var(--font-precio);
    font-size: var(--size-precio);
    color: var(--color-precio);
    font-weight: bold;
    margin-left: 12px;
    white-space: nowrap;
  }

  .menu-item.destacado {
    background: #f7f7f7 !important;       /* gris muy claro */
    border-left: 4px solid #9e9e9e !important; /* gris medio */
    border-radius: 6px;
    padding: 0.4rem 0.6rem;
    opacity: 0.7;
  }

  /* === FOOTER === */
  .footer {
    font-family: var(--font-info-resto);
    font-size: var(--size-info-resto);
    color: var(--color-info-resto);
    text-align: center;
    border-top: 1px solid #ddd;
    margin-top: 2rem;
    padding: 10px 0;
    column-span: all;
    position: fixed;
  }

  @media screen {
    .footer {
      position: relative;
      bottom: 0;
      width: 100%;
    }
  }
  /* === RESPONSIVE === */
  @media (max-width: 768px) {
    body {
      column-count: 1 !important;
      padding: 10px;
    }

  }

  /* === MODO IMPRESI√ìN === */
  @media print {
    @page {
      size: A4;
      margin: 10mm 8mm 10mm 8mm;
    }
    * {
      -webkit-print-color-adjust: exact !important;
      print-color-adjust: exact !important;
      color-adjust: exact !important;
    }

    .menu-item.destacado {
      background: #f7f7f7 !important;       /* gris muy claro */
      border-left: 4px solid #9e9e9e !important; /* gris medio */
      border-radius: 6px !important;
      padding: 0.4rem 0.6rem !important;
      opacity: 0.7;
    }

    .print-background {
      opacity: var(--bg-opacity) !important;
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }

    .footer {
      position: fixed;
      bottom: 0;
      width: 100%;
      background: var(--color-bg);
      border-top: 1px solid #ccc;
      color: var(--color-info-resto);
      padding: 6px 0;
    }

    .menu-item, .resto-header {
      break-inside: avoid;
      page-break-inside: avoid;
    }
  }

  #menu-frame {
    position: relative;
    box-sizing: border-box;
    border-radius: 12px;
    transition: all 0.25s ease;
    background: var(--color-bg);
    z-index: 1;
    display: flex;
    flex-direction: column;
    min-height: 100vh; 
    padding-bottom: 8mm !important;
  }

  #menu-inner {
    flex: 1; /* ‚úÖ el contenido ocupa el espacio disponible arriba del footer */
  }

  /* ornamentos: base gen√©rica */
  #menu-frame::before,
  #menu-frame::after {
    content: "";
    position: absolute;
    width: 120px;
    height: 120px;
    background-size: contain;
    background-repeat: no-repeat;
    opacity: 0.4;
    pointer-events: none;
    z-index: -1;
  }

  /* Esquinas inferiores adicionales */
  #menu-frame::before {
    top: -10px;
    left: -10px;
  }
  #menu-frame::after {
    bottom: -10px;
    right: -10px;
    transform: rotate(180deg);
  }

body.formato-ancho #menu-columns-wrapper {
  display: flex;
  flex-direction: column;
  gap: 2rem;
  width: 100%;
}

/* === FORMATO POR COLUMNAS === */
body.formato-columnas-reales #menu-columns-wrapper {
  display: flex;
  justify-content: space-between;
  gap: 2rem;
}

/* columnas internas creadas por JS */
body.formato-columnas-reales #menu-columns-wrapper .columna {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 2rem;
}

/* Bloques */
.categoria-bloque {
  break-inside: avoid;
  page-break-inside: avoid;
  width: 100%;
}

  
</style>

</head>
<body>
  <div id="menu-frame">
    <div id="menu-inner">
      <!-- üåÑ Fondo -->
      <div class="print-background"></div>

      <!-- üè™ Encabezado -->
      <div class="resto-top">
        <div class="resto-header">
          <img src="https://res.cloudinary.com/drxznqm61/image/upload/v1758652390/The_Pent_2_a8vhtp.jpg" 
              alt="Logo" id="logo-resto">
        </div>
        <div class="resto-info">
          <h1 id="nombre-resto">Caf√© Central</h1>
          <h3 id="subtitulo-resto" class="resto-slogan">Todo rico, todo el d√≠a</h3>
        </div>
      </div>

      <!-- üìú Contenido del men√∫ -->
      <div id="menu-columns-wrapper">
        <div id="menuTable"></div>
      </div>
    </div>
    <div class="footer">
      üìç Av. Corrientes 123 &nbsp;|&nbsp; üìû +54 11 1234-5678 &nbsp;|&nbsp; üïì Martes a Domingos de 8 a 20hs
    </div>
  </div>
  
<script>
/* === Datos base de ejemplo === */
window.parent.postMessage({ type: "ready" }, "*");

const allRows = [
    ["Cafeter√≠a", "Cl√°sicos", "Caf√© en Jarrito", "Caf√© espresso", "$1200"],
    ["Cafeter√≠a", "Cl√°sicos", "Caf√© con Leche", "Caf√© espresso con leche caliente.", "$1300"],
    ["Cafeter√≠a", "Cl√°sicos", "Caf√© Doble", "Caf√© filtrado suave, taza grande.", "$1100", "destacado"],
    ["Cafeter√≠a", "Especiales", "Flat White", "Espresso doble con leche microespumada.", "$1500"],
    ["Cafeter√≠a", "Especiales", "Latte Vainilla", "Caf√© con leche y sirope de vainilla.", "$1600"],
    ["Cafeter√≠a", "Especiales", "Cappuccino", "Espresso, leche y espuma, decorado con cacao.", "$1400"],
    ["Cafeter√≠a", "Fr√≠os", "Cold Brew", "Caf√© infusionado en fr√≠o por 12 horas.", "$1700"],
    ["Cafeter√≠a", "Fr√≠os", "Iced Latte", "Caf√© espresso, leche y hielo.", "$1600", "celiaco"],
    
    ["Pasteler√≠a", "Tortas", "Cheesecake", "Porci√≥n de cheesecake casero.", "$2200"],
    ["Pasteler√≠a", "Tortas", "Brownie", "Brownie de chocolate con nuez y bocha de helado de lim√≥n.", "$1800"],
    ["Pasteler√≠a", "Tortas", "Carrot Cake", "Bizcocho h√∫medo de zanahoria y especias.", "$2100"],
    ["Pasteler√≠a", "Tortas", "Lemon Pie", "Tarta de lim√≥n con merengue italiano.", "$2000", "destacado"],
    
    ["Pasteler√≠a", "Cookies", "Cookie Chips", "Galleta artesanal con chips de chocolate.", "$900"],
    ["Pasteler√≠a", "Cookies", "Cookie Red Velvet", "Galleta roja con chocolate blanco.", "$950"],
    
    ["Sandwiches", "", "Tostado de Jam√≥n y Queso", "Pan casero, jam√≥n cocido y queso.", "$2000"],
    ["Sandwiches", "", "Bagel Capresse", "Bagel artesanal, tomate, mozzarella y albahaca.", "$2300", "vegetariano"],
    ["Sandwiches", "", "Croissant Veggie", "Croissant con vegetales grillados y queso.", "$2200", "vegano"],
    
    ["Desayunos", "", "Combo Central", "Caf√© + jugo + tostadas + mermelada y manteca.", "$2500"],
    ["Bebidas", "Jugos Naturales", "Jugo de Naranja Natural", "Jugo exprimido al momento.", "$800"],
    ["Bebidas", "Jugos Naturales", "Jugo de Manzana y Zanahoria", "Fresco y revitalizante.", "$900"],
    
    ["Saludables", "Yogur", "Yogur Natural", "Limonada casera con menta y albahaca.", "$850"],
    ["Saludables", "Yogur", "Yogur con Granola y Frutas", "Yogur natural con granola y frutas de estaci√≥n", "$2000", "celiaco"],
    
    ["Desayunos", "", "Granola Bowl", "Yogur natural, granola casera y frutas frescas.", "$1800"],
    ["Desayunos", "", "Tostadas Avocado", "Pan integral, palta, tomate y semillas.", "$2100", "vegano"],
    
    ["Cafeter√≠a", "Especiales", "Mocha Latte", "Caf√© espresso con leche vaporizada y chocolate.", "$1700"],
    ["Cafeter√≠a", "Especiales", "Caramel Macchiato", "Espresso con leche, espuma y toque de caramelo.", "$1750"],
    
    ["Cafeter√≠a", "Fr√≠os", "Espresso Tonic", "Espresso servido sobre t√≥nica y hielo.", "$1600"],
    ["Cafeter√≠a", "Fr√≠os", "Affogato", "Helado de vainilla ba√±ado con espresso caliente.", "$1900", "celiaco"],
    ["Cafeter√≠a", "Fr√≠os", "Iced Matcha Latte", "T√© matcha japon√©s con leche vegetal y hielo.", "$1800", "vegano"],
    
    ["Cafeter√≠a", "Fr√≠os", "Frappuccino Oreo", "Frapp√© de caf√© con galletas Oreo y crema.", "$2000"],
    ["Cafeter√≠a", "Fr√≠os", "Limonada Menta & Jengibre", "Refrescante, casera y natural.", "$1500"],
    ["Cafeter√≠a", "Fr√≠os", "Smoothie Frutos Rojos", "Batido con yogur natural y frutas del bosque.", "$1900", "celiaco"],
    
    ["Pasteler√≠a", "", "Muffin de Banana Vegano", "Sin l√°cteos, sin huevo, con nueces y banana.", "$1300", "vegano"],
    ["Pasteler√≠a", "Reposter√≠a", "Cinnamon Roll", "Roll de canela con glaseado de vainilla.", "$1600"],
    ["Pasteler√≠a", "Reposter√≠a", "Mini Tarta de Manzana", "Tarta individual con manzana caramelizada.", "$1700"],
    
    ["Sandwiches", "", "Focaccia de Pollo", "Pan focaccia, pollo grillado, r√∫cula y pesto.", "$2400", "destacado"],
    ["Desayunos", "", "Huevos Benedicto", "Pan de campo, jam√≥n cocido, huevo poch√© y salsa holandesa.", "$2600"],
    ["Desayunos", "", "Brunch Central", "Huevos, tostadas, caf√©, jugo y mini torta.", "$3200", "celiaco", "destacado"],
    
    ["Pasteler√≠a", "Sin Gluten", "Brownie sin TACC", "Brownie h√∫medo con almendras sin gluten.", "$1400", "celiaco", "destacado"],
    ["Sandwiches", "", "Tostado Vegano", "Pan integral, hummus, palta y tomate seco.", "$2100", "vegano"],
    ["Sandwiches", "", "Croissant Capresse", "Croissant con tomate, albahaca y mozzarella.", "$2300", "vegetariano"]
  ];


/* === Render din√°mico del men√∫ === */
function renderMenu(rows) {
  const container = document.getElementById("menuTable");
  container.innerHTML = "";

  const grouped = {};
  rows.forEach(([cat, subcat, nombre, desc, precio, ...extras]) => {
    if (!cat) return;
    if (!grouped[cat]) grouped[cat] = {};
    const sub = subcat || "-";
    if (!grouped[cat][sub]) grouped[cat][sub] = [];
    grouped[cat][sub].push({ nombre, desc, precio, extras });
  });

  // convertir categor√≠as a bloques
  const cats = Object.entries(grouped);
  cats.forEach(([cat, subs]) => {
    const catDiv = document.createElement("div");
    catDiv.classList.add("categoria-bloque");
    const catTitle = document.createElement("h2");
    catTitle.textContent = cat;
    catDiv.appendChild(catTitle);

    Object.entries(subs).forEach(([sub, items]) => {
      if (sub && sub !== "-") {
        const subTitle = document.createElement("h3");
        subTitle.textContent = sub;
        catDiv.appendChild(subTitle);
      }
      items.forEach(item => {
        const div = document.createElement("div");
        div.className = "menu-item";
        if (item.extras.includes("destacado")) div.classList.add("destacado");
        div.innerHTML = `
          <div class="menu-plate">
            <h4>${item.nombre}</h4>
            <p class="menu-description">${item.desc || ""}</p>
          </div>
          <span class="menu-price">${item.precio}</span>
        `;
        catDiv.appendChild(div);
      });
    });
    container.appendChild(catDiv);
  });
}


renderMenu(allRows);

// === SISTEMA DE COLUMNAS DIN√ÅMICO ===
let bloquesOriginales = [];

function capturarBloquesOriginales() {
  const wrapper = document.getElementById('menu-columns-wrapper');
  if (!wrapper) return;
  bloquesOriginales = Array.from(wrapper.querySelectorAll('.categoria-bloque'));
}

function limpiarWrapper() {
  const wrapper = document.getElementById('menu-columns-wrapper');
  if (wrapper) wrapper.innerHTML = '';
}

function distribuirColumnas() {
  const wrapper = document.getElementById('menu-columns-wrapper');
  if (!wrapper || bloquesOriginales.length === 0) return;

  limpiarWrapper();

  const cols = parseInt(getComputedStyle(document.documentElement)
                 .getPropertyValue('--menu-columns')) || 2;

  // Crear contenedores de columnas
  const columnas = [];
  for (let i = 0; i < cols; i++) {
    const col = document.createElement('div');
    col.className = 'columna';
    columnas.push(col);
    wrapper.appendChild(col);
  }

  // Repartir las categor√≠as equilibradamente
  let index = 0;
  bloquesOriginales.forEach(b => {
    columnas[index % cols].appendChild(b);
    index++;
  });
}

function restaurarAnchoCompleto() {
  const wrapper = document.getElementById('menu-columns-wrapper');
  if (!wrapper || bloquesOriginales.length === 0) return;

  limpiarWrapper();
  bloquesOriginales.forEach(b => wrapper.appendChild(b));
}

// === Escucha los mensajes del editor ===
window.addEventListener('message', event => {
  const { type, data } = event.data || {};
  const root = document.documentElement;

  switch (type) {
    case 'formato':
      document.body.classList.remove('formato-ancho', 'formato-columnas-reales');

      if (data === 'ancho') {
        document.body.classList.add('formato-ancho');
        // retraso leve para evitar bloqueo de botones
        setTimeout(() => restaurarAnchoCompleto(), 50);
      }

      if (data === 'columnas-reales') {
        document.body.classList.add('formato-columnas-reales');
        setTimeout(() => distribuirColumnas(), 50);
      }
      break;

    case 'columns':
      root.style.setProperty('--menu-columns', data);
      if (document.body.classList.contains('formato-columnas-reales')) {
        setTimeout(() => distribuirColumnas(), 50);
      }
      break;
  }
});

// Captura inicial
window.addEventListener('DOMContentLoaded', () => {
  capturarBloquesOriginales();
});


// Llamar autom√°ticamente al cambiar formato
window.addEventListener('message', event => {
  const { type, data } = event.data || {};
  if (type === 'formato' && data === 'columnas-reales') {
    distribuirColumnas();
  }
  if (type === 'columns') {
    document.documentElement.style.setProperty('--menu-columns', data);
    if (document.body.classList.contains('formato-columnas-reales')) distribuirColumnas();
  }
});

/* === Listener global para comunicaci√≥n con editor === */
window.addEventListener("message", event => {
  const { type, data } = event.data || {};
  if (!type) return;

  const root = document.documentElement;

  switch (type) {
    case "color-section": {
      const { section, value } = data;
      root.style.setProperty(`--color-${section}`, value);
      document.querySelectorAll(getSelector(section))
        .forEach(el => (el.style.color = value));
      break;
    }
    case "font-section": {
      const { section, font } = data;
      root.style.setProperty(`--font-${section}`, `'${font}', sans-serif`);
      document.querySelectorAll(getSelector(section))
        .forEach(el => (el.style.fontFamily = `'${font}', sans-serif`));
      break;
    }
    case "size-section": {
      const { section, value } = data;
      root.style.setProperty(`--size-${section}`, `${value}rem`);
      break;
    }
    case "firulete":
      root.style.setProperty("--firulete", `"${data}"`);
      break;
    case "opacity":
      root.style.setProperty("--bg-opacity", data);
      document.querySelector(".print-background")?.style.setProperty("opacity", data);
      break;
    case "columns": {
      // data viene como n√∫mero (1,2,3)
      root.style.setProperty('--menu-columns', data);
      // aplicar inline al wrapper para forzar inmediatamente el cambio (compatibilidad)
      const wrapper = document.getElementById('menu-columns-wrapper');
      if (wrapper) {
        wrapper.style.columnCount = String(data);
        wrapper.style.columnGap = '2rem';
      }
      console.log(`‚¨õ Columnas aplicadas: ${data}`);
      break;
    }
    case "formato": {
      document.body.classList.remove("formato-ancho", "formato-columnas-reales");
      if (data === "ancho") document.body.classList.add("formato-ancho");
      if (data === "columnas-reales") document.body.classList.add("formato-columnas-reales");
      break;
    }
    case "frame-style":
      document.body.style.borderStyle = data;
      break;
    case "frame-color":
      document.body.style.borderColor = data;
      break;
    case "frame-width":
      document.body.style.borderWidth = data + "px";
      break;
  }
});



/* üîç Traductor de secciones */
function getSelector(section) {
  switch (section) {
    case "nombre":
    case "nombre-resto":
      return "#nombre-resto, .resto-info h1";
    case "slogan":
    case "nombre-slogan":
      return "#subtitulo-resto, .resto-slogan, .resto-info h3";
    case "categoria":
      return "h2";
    case "subcategoria":
      return "h3";
    case "plato":
      return ".menu-plate h4";
    case "descripcion":
      return ".menu-description";
    case "precio":
      return ".menu-price";
    case "info-resto":
      return ".footer";
    default:
      return "body";
  }
}

function doGet(e) {
  const nombre = e.parameter.nombre || "default";
  const ss = SpreadsheetApp.openById("TU_SHEET_ID");
  const sheet = ss.getSheetByName("Formatos");
  const data = sheet.getDataRange().getValues();

  const row = data.find(r => r[0] === nombre);
  if (!row) return ContentService.createTextOutput("{}");

  const formato = JSON.parse(row[1]);
  return ContentService.createTextOutput(JSON.stringify(formato))
    .setMimeType(ContentService.MimeType.JSON);
}

</script>
</body>
</html>
