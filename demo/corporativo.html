<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Demo Plan Corporativo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <link rel="icon" type="image/png" href="../../MLfavicon.png" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    :root {
      --primary: #ffc107;
      --bg: #f1f1f1;
      --text: #212529;
      --header: #d2d0cd;
      --border: #dee2e6;
      --radius: 10px;
    }
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      padding: 0;
    }
    header {
      background: var(--header);
      color: #fff;
      padding: 1.2rem 1rem 0.7rem 1rem;
      text-align: center;
      border-radius: 0 0 var(--radius) var(--radius);
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 1rem;
    }
    .fijos {
      margin: 1.5rem 0 1rem 0;
      padding: 0.7rem 1rem;
      background: #f8f9fa;
      border-radius: var(--radius);
      font-size: 1rem;
      color: #444;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
      background: #fff;
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: 0 2px 8px #0001;
    }
    th, td {
      padding: 0.8rem 0.5rem;
      border-bottom: 1px solid var(--border);
      text-align: left;
      font-size: 1rem;
    }
    th {
      background: #f1f1f1;
      font-weight: 700;
      color: #343a40;
    }
    tr:last-child td {
      border-bottom: none;
    }
    @media (max-width: 700px) {
      .container { padding: 0.5rem; }
      th, td { font-size: 0.97rem; padding: 0.6rem 0.3rem; }
      .fijos { font-size: 0.97rem; padding: 0.5rem 0.7rem; }
    }
    /* Estas tres van fuera del @media */
    .menu-item-inner { display:flex; align-items:center; }
    .menu-text { width:100%; text-align:left; flex:1; }
    .menu-img { width:100%; max-width:180px; height:auto; margin-bottom:0.5rem; }

@media (max-width: 480px) {
      header {
        font-size: 1.2rem;
        padding: 0.8rem 0.3rem;
      }
      .container {
        padding: 0.2rem;
      }
      th, td {
        font-size: 0.93rem;
        padding: 0.4rem 0.2rem;
      }
    }

    .menu-group {
      margin-top: 0.5rem;
      margin-bottom: 1.2rem;
    }

    .menu-group h2 {
      font-size: 1.7rem;
      margin: 2rem 0 0.2rem;
      border-bottom: 2px solid #ddd;
      color: #333;
    }

    .menu-group h3 {
      font-size: 1.5rem;
      margin: 1rem 0 0rem;
      color: #555;
    }

    .menu-group h4 {
      font-size: 1.2rem;
      margin: 1rem 0 0rem;
      color: #555;
    }

    .menu-item {
      border-bottom: 1px solid #eee;
      margin: -.5rem 0 -.5rem;
      padding: 0.8rem 0;
    }

    .menu-item-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 0.5rem;
    }

    .menu-item-inner {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      padding: 1rem;
      border-radius: 8px;
      background-color: #fff;
      box-shadow: 0 1px 4px rgba(0,0,0,0.05);
    }

    .menu-img {
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 10px;
      flex-shrink: 0;
      margin: 0;
    }




.menu-price {
  font-size: 1.1rem;
  font-weight: bold;
  color: #111;
  margin-top: 0.4rem;
}

    @media (max-width: 600px) {
      .menu-name {
        font-size: 1rem;
      }

    }
    .menu-content {
      margin-top: 2rem;
    }

    .category-menu {
      display: flex;
      gap: 12px;
      justify-content: center;
      align-items: center;
      margin: 0 0 0.5rem 0;
      flex-wrap: nowrap;
      overflow-x: auto;
      padding-top: 8px;
      padding-bottom: 8px;
      scrollbar-width: thin;
      scrollbar-color: #457B9D #eee;
      position: sticky;
      top: 50px;
      z-index: 1000;
    }
    #categoryMenu {
      margin-top: -0.2rem;
    }
    .category-menu::-webkit-scrollbar {
      height: 6px;
    }
    .category-menu::-webkit-scrollbar-thumb {
      background: #457B9D;
      border-radius: 10px;
    }
    .search-menu {
      text-align: center;
      margin: 1rem 0;
      position: sticky;
      margin-top: -15px;
      padding-top: 8px;
    }
    .category-btn {
      background: #457B9D;
      color: #fff;
      border: none;
      border-radius: 20px;
      padding: 7px 18px;
      font-weight: 600;
      cursor: pointer;
      font-size: 1rem;
      transition: background 0.2s;
      flex: 0 0 auto;
    }
    .category-btn:hover, .category-btn.active {
      background: #457B9D;
    }

    .header-flex {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      flex-wrap: wrap;
      gap: 0.5rem;
      font-family: 'Poppins', sans-serif;
      flex-direction: column !important;
      align-items: center !important;
      text-align: center !important;
    }
    .header-left, .header-right {
      width: 100% !important;
      text-align: center !important;
    }
    .header-right {
      margin-top: 0.5rem !important;
    }
    @media (max-width: 600px) {
      .header-flex {
        flex-direction: column;
        gap: 0.2rem;
        margin-bottom: 0px;
      }
      .header-left {
        text-align: left;
        margin-top: 0px;
        margin-bottom: 0px;
        width: 100%;
      }
      .header-right {
        margin-top: 0.3rem;
        margin-bottom: 0px;
        width: 100%;
        min-width: unset;
      }
      .header-left h1, .header-left h2 {
        margin: 0.2rem 0; 
      }
      .header-right div {
        margin-top: 0.3rem; /* acercálo al bloque superior */
      }
    }

    /* Estilos para el botón de WhatsApp flotante */
    #whatsapp-float {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #25D366;
      color: white;
      border: none;
      border-radius: 50%;
      width: 56px;
      height: 56px;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      z-index: 1000;
      transition: background 0.3s;
    }

    #whatsapp-float:hover {
      background: #128C7E;
    }

    #whatsapp-float img {
      width: 24px;
      height: 24px;
    }

    .header-socials {
        text-align: center;
        margin: 0rem 10px 0.5rem 10px;
        background-color: #f1f1f1; /* gris clarito */
        border-radius: 10px; /* bordes redondeados */
        padding: 0.5rem 1rem; /* opcional, para que respire */
        margin-top: 0.2rem !important;
    }

    .header-socials a {
      margin: 0 10px;
      display: inline-block;
    }

    .header-socials img {
      width: 30px;
      height: 30px;
      transition: transform 0.3s;
    }

    .header-socials img:hover {
      transform: scale(1.1);
    }

    .pedido-checkbox {
      accent-color: #E639A6;
      width: 12px;
      height: 12px;
    }
    .menu-item.selected .menu-item-inner {
      background: #457B9D !important; /* azul oscuro */
      border-radius: 10px;
    }

    .menu-item.selected .menu-name,
    .menu-item.selected .menu-description,
    .menu-item.selected .menu-price {
      color: #fff !important;
    }

    .menu-item.selected .menu-img {
      filter: none !important;
      opacity: 1 !important;
    }
    .whatsapp-tooltip {
      display: none;
      position: absolute;
      bottom: 70px;
      right: 0;
      background: rgba(0, 0, 0, 0.7);
      color: #fff;
      padding: 0.5rem;
      border-radius: 8px;
      font-size: 0.9rem;
      white-space: nowrap;
      z-index: 1001;
    }

    #whatsapp-float:hover .whatsapp-tooltip {
      display: block;
    }
    .style-nombre {
      font-size:1.8rem;
      color:#000; 
      margin-top:0;
    }
    .style-subtitulo {
      font-size:1rem;
      color:#000; 
      margin-top:0; 
      margin-bottom:0.3rem; 
      font-style:italic; 
      font-weight:400;
    }

    #totalBar {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      background: #fff;
      border-top: 1px solid #e9ecef;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.06);
      padding: 0.8rem 1rem;
      font-weight: 700;
      font-size: 1.05rem;
      text-align: center;
      z-index: 1100; /* por encima del contenido y debajo del popup */
    }

    /* para que el contenido no quede tapado por la barra */
    body { padding-bottom: 72px; }

    /* que el botón de WhatsApp no quede escondido detrás de la barra */
    #whatsapp-float { bottom: 90px; }
    @media (max-width: 600px) {
      #whatsapp-float { bottom: 88px; }
    }

    /* Barra de total fija */
    #totalBar{
      position: fixed; left: 0; right: 0; bottom: 0;
      background: #fff; border-top: 1px solid #e9ecef;
      box-shadow: 0 -2px 10px rgba(0,0,0,.06);
      padding: .8rem 1rem;
      font-weight: 700; font-size: 1.05rem;
      z-index: 1100;
      display: flex; justify-content: center; align-items: center; gap: 12px;
    }

    /* que nada quede tapado por la barra */
    body{ padding-bottom: 72px; }

    /* botón pagar */
    #payButton{
      display: none;           /* se muestra solo con selección */
      background: #457B9D;     /* tu color */
      color: #fff; 
      text-decoration: none;
      border-radius: 999px; padding: .55rem 1rem;
      font-weight: 700; font-size: .98rem;
    }
    #payButton.show{ display: inline-block; }

    .qty {
      display:flex; align-items:center; gap:8px;
      margin-top:.5rem; user-select:none;
    }
    .qty button{
      width:28px; height:28px; border-radius:6px; border:1px solid #ddd;
      background:#f6f6f6; font-weight:700; cursor:pointer;
    }
    .qty input{
      width:48px; text-align:center; border:1px solid #ddd; border-radius:6px; padding:4px 6px;
    }
    .line-total{
      display: none !important;
    }
    .menu-item.selected .line-total{ color:#fff; }

  </style>
</head>
<body>
  <img src="https://res.cloudinary.com/drxznqm61/image/upload/v1752632048/cafe-central_ne83eh.png" alt="Banner Cafe Central" style="width:100%;display:block;margin-bottom:0.5rem;">
  <div class="container">
    <div class="header-flex">
      <div class="header-left">
        <h1 id="nombre-resto" class="style-nombre">Café Central</h1>
        <h2 id="subtitulo-resto" class="style-subtitulo">
          Todo rico, todo el día
        </h2>
      </div>
      <div class="header-right">
        <div>
          <span class="style-direccion"><i class="fa-solid fa-map-marker-alt"></i> Av. Corrientes 123</span>        </div>
        <div>
          <span class="style-horarios"><i class="fa-solid fa-clock"></i> de Martes a Domingos de 8 a 20hs</span>
        </div>
      </div>
      <div class="header-socials" id="headerSocials"></div>
    </div>
  </div>
  <div id="reservaBtnContainer" style="text-align:center; margin-bottom: 0.7rem; display:none;">
    <button id="btnReserva" class="category-btn" style="font-size:1.08rem; padding:8px 28px; margin-top:0.5rem;">
      📅 Reservá tu mesa
    </button>
  </div>
  <div id="deliveryBtnContainer" style="text-align:center; margin-bottom: 0.7rem; display:none;">
    <button id="btnDelivery" class="category-btn" style="font-size:1.08rem; padding:8px 28px; margin-top:0.5rem;">
      <i class="fa-solid fa-burger" style="margin-right:8px;"></i>Pedí Delivery
    </button>
  </div>

<div class="header-socials" id="headerSocials">
</div>
    <div class="search-menu">
    <input
      id="menuSearch"
      type="text"
      placeholder="Buscar en el menú..."
      style="padding: 0.5rem 1rem; border-radius: 20px; border: 1px solid #ccc; width: 90%; max-width: 400px; font-size: 1rem;"
    />
  </div>
  <div id="categoryMenu" class="category-menu"></div>
  <div class="container">
    <div style="overflow-x:auto;">
      <div id="menuTable" class="menu-content"></div>
    </div>
    <div id="noResults" style="display:none;text-align:center;color:#dc3545;margin-top:1.5rem;font-size:1.1rem;">
      No se encontraron platos con ese criterio.
    </div>
  </div>
  <footer style="background:#f1f1f1;color:#333;text-align:center;padding:1rem 0 1.2rem 0;font-size:1rem;">
    <span class="thq-body-small">Desarrollado por</span>  
    <a href="https://menulab.com.ar" target="_blank" rel="noopener">
      <span style="display: inline-block; margin-left: 12px;">
        <h1 style="font-family: 'Unbounded', sans-serif; font-weight: 600; font-size: 100%;
          margin-left: -10px;
          background: linear-gradient(90deg, #E639A6, #457B9D);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;">
          MenuLab
        </h1>
      </span>
    </a>
  </footer>

  <!-- Botón de WhatsApp flotante con viñeta -->
  <a href="https://wa.me/5491130625858" target="_blank" id="whatsapp-float" aria-label="WhatsApp">
    <span class="whatsapp-tooltip">¡Hacé tu pedido por WhatsApp!</span>
    <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp" style="width:56px;height:56px;">
  </a>

  <!-- Promo PopUp -->
  <div id="promoPopup" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.45); z-index:3000; justify-content:center; align-items:center;">
    <div id="promoContent" style="position:relative; background:#fff; border-radius:16px; box-shadow:0 4px 32px #0003; padding:0; max-width:90vw; max-height:80vh; display:flex; flex-direction:column; align-items:center;">
      <!-- Botón de cierre -->
      <button onclick="document.getElementById('promoPopup').style.display='none'" 
              style="position:absolute; top:10px; right:12px; background:transparent; border:none; font-size:1.5rem; color:#999; cursor:pointer;">
        &times;
      </button>
      <img id="promoImage" alt="Promo de Temporada"
          style="width:100%; max-width:400px; height:auto; border-radius:12px; display:block;">
    </div>
  </div>
  <div id="totalBar" aria-live="polite">
    <span id="totalText">Total: $0</span>
    <span id="whatsappMsg" style="display:none; color:#25D366; font-weight:700; font-size:1.08rem; margin-left:16px;">
      Hacé tu pedido por WhatsApp!
    </span>
  </div>
  <div id="google_translate_element" style="position:fixed;top:8px;right:8px;z-index:9999;"></div>
  <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
  
  <script>
    // URL de la promo (dejá "" vacío si no querés mostrar nada)
    //const promoUrl = "https://res.cloudinary.com/drxznqm61/image/upload/v1752803985/Felices_Pascuas_Instagram_story_etspb5.jpg";
    const promoUrl = "";

    if (promoUrl) {
      document.getElementById("promoImage").src = promoUrl;
      document.getElementById("promoPopup").style.display = "flex";
    } else {
      // si no hay URL -> eliminar el popup del DOM
      const popup = document.getElementById("promoPopup");
      if (popup) popup.remove();
    }

    const allRows = [
      ["Cafetería", "Clásicos", "Café en Jarrito", "Café espresso", "$1200", "https://res.cloudinary.com/drxznqm61/image/upload/v1757092774/jarrito-removebg-preview_1_mk6kdz.png"],
      ["Cafetería", "Clásicos", "Café con Leche", "Café espresso con leche caliente.", "$1300"],
      ["Cafetería", "Clásicos", "Café Americano", "Café filtrado suave, taza grande.", "$1100", "https://res.cloudinary.com/drxznqm61/image/upload/v1757093211/tazon-removebg-preview_sdkftc.png"],
      ["Cafetería", "Especiales", "Flat White", "Espresso doble con leche microespumada.", "$1500", "https://res.cloudinary.com/drxznqm61/image/upload/v1757093642/76cbc8bc-eca2-40ca-a094-cce4551354c0-removebg-preview_xhzbsi.png"],
      ["Cafetería", "Especiales", "Latte Vainilla", "Café con leche y sirope de vainilla.", "$1600"],
      ["Cafetería", "Especiales", "Cappuccino", "Espresso, leche y espuma, decorado con cacao.", "$1400"],
      ["Cafetería", "Fríos", "Cold Brew", "Café infusionado en frío por 12 horas.", "$1700"],
      ["Cafetería", "Fríos", "Iced Latte", "Café espresso, leche y hielo.", "$1600", "https://res.cloudinary.com/drxznqm61/image/upload/v1757093806/espresso_tonic_1-removebg-preview_zkjdj8.png"],
      ["Pastelería", "Tortas", "Cheesecake", "Porción de cheesecake casero.", "$2200", "https://res.cloudinary.com/drxznqm61/image/upload/v1757094394/cheesecake-removebg-preview_1_ob73z1.png"],
      ["Pastelería", "Tortas", "Brownie", "Brownie de chocolate con nuez y bocha de helado de limón.", "$1800", "https://res.cloudinary.com/drxznqm61/image/upload/v1757094737/brownie-removebg-preview_ahn7yw.png"],
      ["Pastelería", "Tortas", "Carrot Cake", "Bizcocho húmedo de zanahoria y especias.", "$2100"],
      ["Pastelería", "Tortas", "Lemon Pie", "Tarta de limón con merengue italiano.", "$2000"],
      ["Pastelería", "Cookies", "Cookie Chips", "Galleta artesanal con chips de chocolate.", "$900", "https://res.cloudinary.com/drxznqm61/image/upload/v1757095030/The-Best-Chocolate-Chip-Cookies-2-removebg-preview_1_iacu2g.png"],
      ["Pastelería", "Cookies", "Cookie Red Velvet", "Galleta roja con chocolate blanco.", "$950"],
      ["Sandwiches", "", "Tostado de Jamón y Queso", "Pan casero, jamón cocido y queso.", "$2000"],
      ["Sandwiches", "", "Bagel Capresse", "Bagel artesanal, tomate, mozzarella y albahaca.", "$2300", "https://res.cloudinary.com/drxznqm61/image/upload/v1753625624/Bagel-de-salmon-removebg-preview_jia8vv.png"],
      ["Sandwiches", "", "Croissant Veggie", "Croissant con vegetales grillados y queso.", "$2200"],
      ["Desayunos", "", "Combo Central", "Café + jugo + tostadas + mermelada y manteca.", "$2500"],
      ["Bebidas", "Jugos Naturales", "Jugo de Naranja Natural", "Jugo exprimido al momento.", "$800", "https://res.cloudinary.com/drxznqm61/image/upload/v1753625743/limonadaembotella-removebg-preview_ajszh4.png"],
      ["Bebidas", "Jugos Naturales", "Jugo de Manzana y Zanahoria", "Fresco y revitalizante.", "$900", "https://res.cloudinary.com/drxznqm61/image/upload/v1753625743/limonadaembotella-removebg-preview_ajszh4.png"],
      ["Saludables", "Yogur", "Yogur Natural", "Limonada casera con menta y albahaca.", "$850", "https://res.cloudinary.com/drxznqm61/image/upload/v1753625560/Yogur-Griego-con-Frutos-Rojos-y-Granola-Casera-removebg-preview_vqcagd.png"],
      ["Saludables", "Yogur", "Yogur con Granola y Frutas", "Yogur natural con granola casera y frutas de estación", "2000", "https://res.cloudinary.com/drxznqm61/image/upload/v1753625560/Yogur-Griego-con-Frutos-Rojos-y-Granola-Casera-removebg-preview_vqcagd.png"],
      ["Desayunos", "", "Granola Bowl", "Yogur natural, granola casera y frutas frescas.", "$1800"],
      ["Desayunos", "", "Tostadas Avocado", "Pan integral, palta, tomate y semillas.", "$2100"],
      ["Cafetería", "Especiales", "Mocha Latte", "Café espresso con leche vaporizada y chocolate.", "$1700"],
      ["Cafetería", "Especiales", "Caramel Macchiato", "Espresso con leche, espuma y toque de caramelo.", "$1750"],
      ["Cafetería", "Fríos", "Espresso Tonic", "Espresso servido sobre tónica y hielo.", "$1600"],
      ["Cafetería", "Fríos  ", "Affogato", "Helado de vainilla bañado con espresso caliente.", "$1900", "https://res.cloudinary.com/drxznqm61/image/upload/v1757093536/afogato-removebg-preview_1_ufg02m.png"],
      ["Cafetería", "Fríos", "Iced Matcha Latte", "Té matcha japonés con leche vegetal y hielo.", "$1800"],
      ["Cafetería", "Fríos", "Frappuccino Oreo", "Frappé de café con galletas Oreo y crema.", "$2000"],
      ["Cafetería", "Fríos", "Limonada Menta & Jengibre", "Refrescante, casera y natural.", "$1500", "https://res.cloudinary.com/drxznqm61/image/upload/v1757094184/7WPPD5GSSZH4LG7KHWVEWCPBFM-removebg-preview_ves6p0.png"],
      ["Cafetería", "Fríos", "Smoothie Frutos Rojos", "Batido con yogur natural y frutas del bosque.", "$1900"],
      ["Pastelería", "Vegano", "Muffin de Banana Vegano", "Sin lácteos, sin huevo, con nueces y banana.", "$1300"],
      ["Pastelería", "Sin Gluten", "Brownie sin TACC", "Brownie húmedo con almendras sin gluten.", "$1400"],
      ["Pastelería", "Repostería", "Cinnamon Roll", "Roll de canela con glaseado de vainilla.", "$1600"],
      ["Pastelería", "Repostería", "Mini Tarta de Manzana", "Tarta individual con manzana caramelizada.", "$1700"],
      ["Sandwiches", "", "Focaccia de Pollo", "Pan focaccia, pollo grillado, rúcula y pesto.", "$2400"],
      ["Sandwiches", "", "Croissant Capresse", "Croissant con tomate, albahaca y mozzarella.", "$2300"],
      ["Sandwiches", "", "Tostado Vegano", "Pan integral, hummus, palta y tomate seco.", "$2100"],
      ["Sandwiches", "", "Bagel de Salmón", "Salmón ahumado, queso crema y alcaparras.", "$2700", "https://res.cloudinary.com/drxznqm61/image/upload/v1753625624/Bagel-de-salmon-removebg-preview_jia8vv.png"],
      ["Desayunos", "", "Açai Bowl", "Base de açai con frutas, granola y coco.", "$2000"],
      ["Desayunos", "", "Tostadas Francesas", "Pan brioche con canela, miel y frutos secos.", "$1900"],
      ["Desayunos", "", "Huevos Benedicto", "Pan de campo, jamón cocido, huevo poché y salsa holandesa.", "$2600"],
      ["Desayunos", "", "Brunch Central", "Huevos, tostadas, café, jugo y mini torta.", "$3200"]
      
    ];

    function renderCategoryMenu(rows) {
      const categories = [...new Set(rows.map(r => r[0].trim()).filter(Boolean))];
      const menuDiv = document.getElementById('categoryMenu');
      menuDiv.innerHTML = '';

      categories.forEach(cat => {
        const btn = document.createElement('button');
        btn.className = 'category-btn';
        btn.textContent = cat;
        btn.onclick = () => {
          // Scroll a la sección de la categoría
          const section = document.querySelector(`.menu-group[data-cat="${cat}"]`);
          if (section) {
            section.scrollIntoView({ behavior: 'smooth', block: 'start' });
            // Opcional: marcar el botón activo
            document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
          }
        };
          // 🔥 Esto asegura que el scroll se reinicie después de agregar los botones
        menuDiv.scrollLeft = 0;
        menuDiv.appendChild(btn);
      });
    }

    function renderMenuGrouped(rows) {
      const container = document.querySelector("#menuTable");
      container.innerHTML = "";

      const agrupado = {};
      
      rows.forEach(cols => {
        const [cat, subcat, nombre, desc, precio, imagen] = cols.map(c => c.trim());
        if (!cat || !nombre) return;
        
        if (!agrupado[cat]) agrupado[cat] = {};
        const sub = subcat || "-";
        if (!agrupado[cat][sub]) agrupado[cat][sub] = [];
        agrupado[cat][sub].push({ nombre, desc, precio, imagen });
      });
      
      Object.entries(agrupado).forEach(([cat, subcategorias]) => {
        const group = document.createElement("div");
        group.className = "menu-group";
        group.setAttribute("data-cat", cat);
        
        const catTitle = document.createElement("h2");
        catTitle.textContent = cat;
        group.appendChild(catTitle);
        
        Object.entries(subcategorias).forEach(([subcat, items]) => {
          if (subcat && subcat !== "-") {
            const subTitle = document.createElement("h3");
            subTitle.textContent = subcat;
            group.appendChild(subTitle);
          }
          
          items.forEach((item, idx) => {
            const itemDiv = document.createElement("div");
            const precioNum = parsePrice(item.precio);
            itemDiv.className = "menu-item";
            itemDiv.setAttribute("data-nombre", item.nombre);
            itemDiv.setAttribute("data-precio", String(precioNum));
            itemDiv.setAttribute("data-qty", "0");

            itemDiv.innerHTML = `
              <div class="menu-item-inner">
                <div class="menu-text">
                  <h4 class="menu-name">${item.nombre}</h4>
                  <p class="menu-description">${item.desc || ""}</p>
                  <span class="menu-price">${item.precio}</span>
                  <div class="qty">
                    <button class="qty-minus" type="button" aria-label="Restar">−</button>
                    <input class="qty-input" type="number" value="0" min="0" inputmode="numeric" />
                    <button class="qty-plus" type="button" aria-label="Sumar">+</button>
                    <span class="line-total">—</span>
                  </div>
                </div>
                ${item.imagen ? `<img src="${item.imagen}" alt="${item.nombre}" class="menu-img">` : ""}
              </div>
            `;

            itemDiv.addEventListener('click', function(e){
              if (e.target.closest('.qty')) return; // no hacer toggle si se clickeó en los controles
              const currentQty = Number(itemDiv.getAttribute('data-qty')||"0");
              // Toggle visual si no hay cantidad cargada
              if (currentQty === 0) {
                // 👉 Primera vez que lo selecciona: setear cantidad = 1
                qtyInput.value = 1;
                itemDiv.setAttribute('data-qty', "1");
                itemDiv.classList.toggle('selected');

                // refrescar línea total
                const price = Number(itemDiv.getAttribute('data-precio') || "0");
                const lineTotalEl = itemDiv.querySelector('.line-total');
                lineTotalEl.textContent = formatMoney(price);

                updateTotal();
              } else {
                // 👉 Si ya tiene cantidad, simplemente lo deselecciona (opcional)
                qtyInput.value = 0;
                itemDiv.setAttribute('data-qty', "0");
                itemDiv.classList.remove('selected');
                const lineTotalEl = itemDiv.querySelector('.line-total');
                lineTotalEl.textContent = "—";
                updateTotal();
              }
            });

            const minusBtn = itemDiv.querySelector('.qty-minus');
            const plusBtn  = itemDiv.querySelector('.qty-plus');
            const qtyInput = itemDiv.querySelector('.qty-input');
            const lineTotalEl = itemDiv.querySelector('.line-total');

            function refreshLine(){
              let qty = Math.max(0, parseInt(qtyInput.value || "0", 10));
              if (Number.isNaN(qty)) qty = 0;
              qtyInput.value = String(qty);
              itemDiv.setAttribute('data-qty', String(qty));

              const price = Number(itemDiv.getAttribute('data-precio') || "0");
              const line = qty * price;
              lineTotalEl.textContent = qty > 0 ? formatMoney(line) : "—";

              // estado visual “seleccionado” sólo si qty>0
              itemDiv.classList.toggle('selected', qty > 0);
              updateTotal();
            }

            minusBtn.addEventListener('click', (e)=>{ e.stopPropagation(); qtyInput.value = Math.max(0, (parseInt(qtyInput.value||"0",10) || 0) - 1); refreshLine(); });
            plusBtn .addEventListener('click', (e)=>{ e.stopPropagation(); qtyInput.value = (parseInt(qtyInput.value||"0",10) || 0) + 1; refreshLine(); });
            qtyInput.addEventListener('input', (e)=>{ e.stopPropagation(); refreshLine(); });

            group.appendChild(itemDiv);
          });
        });

        container.appendChild(group);
        updateTotal();
      });
    }

    function filterMenuRows(rows, query) {
      if (!query) return rows;
      const q = query.trim().toLowerCase();
      return rows.filter(cols =>
        cols.some(cell => cell && cell.toLowerCase().includes(q))
      );
    }

    const searchInput = document.getElementById('menuSearch');
    searchInput.addEventListener('input', function () {
      const filtered = filterMenuRows(allRows, this.value);
      renderMenuGrouped(filtered);
      renderCategoryMenu(filtered);
      updateTotal();
      document.getElementById('noResults').style.display = filtered.length === 0 ? "block" : "none";
    });

    // Renderizar menú y categorías
    renderMenuGrouped(allRows);
    renderCategoryMenu(allRows);
    updateTotal();

    const socialLinks = [
      {
        href: "https://www.rappi.com.ar/",
        img: "https://res.cloudinary.com/drxznqm61/image/upload/v1752716379/rappi_oul48p.png",
        alt: "Rappi",
        label: "Rappi"
      },
      {
        href: "https://www.pedidosya.com.ar/",
        img: "https://res.cloudinary.com/drxznqm61/image/upload/v1752716289/pedidosya_q40sz4.png",
        alt: "PedidosYa",
        label: "PedidosYa"
      },
      {
        href: "https://www.instagram.com/",
        img: "https://upload.wikimedia.org/wikipedia/commons/a/a5/Instagram_icon.png",
        alt: "Instagram",
        label: "Instagram"
      },
      {
        href: "https://www.facebook.com/",
        img: "https://upload.wikimedia.org/wikipedia/commons/5/51/Facebook_f_logo_%282019%29.svg",
        alt: "Facebook",
        label: "Facebook"
      },
      {
        href: "https://maps.google.com/?q=Av.+Siempre+Viva+123",
        img: "https://res.cloudinary.com/drxznqm61/image/upload/v1752716133/googlemaps-removebg-preview_xh3ivm.png",
        alt: "Google Maps",
        label: "Google Maps"
      }
    ];

    const socialsDiv = document.getElementById('headerSocials');
    socialLinks.forEach(social => {
      if (social.href && social.href.trim() !== "") {
        const a = document.createElement('a');
        a.href = social.href;
        a.target = "_blank";
        a.setAttribute('aria-label', social.label);
        const img = document.createElement('img');
        img.src = social.img;
        img.alt = social.alt;
        a.appendChild(img);
        socialsDiv.appendChild(a);
      }
    });

    // Mostrar el popup de promo al cargar
    window.onload = () => {
      setTimeout(() => {
        const popup = document.getElementById('promoPopup');
        popup.style.display = 'flex';

        // Cerrar el popup al hacer clic fuera de la caja de contenido
        popup.onclick = (e) => {
          if (e.target === popup) {
            popup.style.display = 'none';
          }
        };
      }, 2000); // 2000ms = 2 segundos
    };

    document.getElementById('whatsapp-float').addEventListener('click', function(e) {
      e.preventDefault();
      const items = document.querySelectorAll('.menu-item');
      const seleccion = [];
      items.forEach(it=>{
        const qty = Number(it.getAttribute('data-qty')||"0");
        if (qty > 0){
          const nombre = it.getAttribute('data-nombre') || 'Plato';
          seleccion.push(`${nombre} x${qty}`);
        }
      });

      if (seleccion.length === 0) {
        window.open(this.href, '_blank');
        return;
      }

      // Total formateado en el mensaje
      let total = 0;
      items.forEach(it=>{
        const qty = Number(it.getAttribute('data-qty')||"0");
        const price = Number(it.getAttribute('data-precio')||"0");
        total += qty * price;
      });

      const mensaje = encodeURIComponent(`Hola, quisiera pedir:\n- ${seleccion.join('\n- ')}\n\nTotal estimado: ${formatMoney(total)}`);
      const url = this.href.split('?')[0] + `?text=${mensaje}`;
      window.open(url, '_blank');
    });

    function parsePrice(str) {
    if (!str) return 0;
    const cleaned = String(str).replace(/[^\d.,-]/g, '').trim();
    if (!cleaned) return 0;

    let numStr = cleaned;
    const lastComma = cleaned.lastIndexOf(',');
    const lastDot = cleaned.lastIndexOf('.');

    // si tiene ambos separadores, usamos el último como decimal
    if (lastComma > -1 && lastDot > -1) {
      if (lastComma > lastDot) {
        numStr = cleaned.replace(/\./g, '').replace(',', '.'); // 1.234,56
      } else {
        numStr = cleaned.replace(/,/g, ''); // 1,234.56
      }
    } else if (lastComma > -1) {
      numStr = cleaned.replace(/\./g, '').replace(',', '.');   // 1.234 -> 1234 ; 123,45 -> 123.45
    } else {
      numStr = cleaned.replace(/,/g, '');                      // 1,234 -> 1234
    }

    const v = parseFloat(numStr);
    return isNaN(v) ? 0 : v;
  }

  function formatMoney(n) {
    try {
      return new Intl.NumberFormat('es-AR', { style:'currency', currency:'ARS', minimumFractionDigits:0 }).format(n || 0);
    } catch(e) {
      // fallback simple
      return '$' + Math.round(n || 0).toString();
    }
  }

  // --- helpers existentes (parsePrice, formatMoney) sirven tal cual ---
  function updateTotal(){
  const items = document.querySelectorAll('.menu-item');
  let total = 0;
  let totalUnits = 0;

  items.forEach(it => {
    const qty = Number(it.getAttribute('data-qty') || "0");
    if (qty > 0){
      const price = Number(it.getAttribute('data-precio') || "0");
      total += qty * price;
      totalUnits += qty;
    }
  });

  document.getElementById('totalText').textContent = `Total: ${formatMoney(total)}`;

  // Mostrar mensaje WhatsApp cuando haya al menos 1 unidad
  const whatsappMsg = document.getElementById('whatsappMsg');
  if (totalUnits > 0){
    whatsappMsg.style.display = "inline-block";
  } else {
    whatsappMsg.style.display = "none";
  }
}

  // URL del formulario de reservas (dejá vacío "" si no hay)
  const reservaUrl = "https://docs.google.com/forms/d/e/1FAIpQLSfKYNJPno7YlifWkBb_oMX_2ZVz0iopmEzwiHL7sxUh_7Polg/viewform?usp=dialog"; // <-- poné tu link aquí

  if (reservaUrl && reservaUrl.trim() !== "") {
    document.getElementById('reservaBtnContainer').style.display = "block";
    document.getElementById('btnReserva').onclick = function() {
      window.open(reservaUrl, '_blank');
    };
  }

  // URL del delivery (dejá vacío "" si no hay)
  const deliveryUrl = "https://wa.me/5491130625858"; // <-- poné tu link aquí

  if (deliveryUrl && deliveryUrl.trim() !== "") {
    document.getElementById('deliveryBtnContainer').style.display = "block";
    document.getElementById('btnDelivery').onclick = function() {
      window.open(deliveryUrl, '_blank');
    };
  }

  </script>
</body>
</html>